<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-99.9.9">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>neutrino_quantum_kinetics – Don Willcox</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for citations */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
  margin-bottom: 1em;
}
.hanging-indent div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./pde_code_generation.html" rel="next">
<link href="./neutron_stars.html" rel="prev">
<script src="site_libs/quarto-html/quarto.js" type="module"></script>
<script src="site_libs/quarto-html/tabsets/tabsets.js" type="module"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting-dark-a0649ace7b9e9e15dfb5fe311d767a49.css" rel="stylesheet" class="quarto-color-scheme quarto-color-alternate" id="quarto-text-highlighting-styles">
<link href="site_libs/quarto-html/quarto-syntax-highlighting-494121dfa8658343c03537e94414993d.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap-dark-c8aa56d841c90a12d715982c9779df2a.min.css" rel="stylesheet" append-hash="true" class="quarto-color-scheme quarto-color-alternate" id="quarto-bootstrap" data-mode="dark">
<link href="site_libs/bootstrap/bootstrap-74f6f170ffbc5ca53a7db2e845b37c0b.min.css" rel="stylesheet" append-hash="true" class="quarto-color-scheme" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>

  <script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

<link rel="stylesheet" href="styles.css">
</head>

<body class="nav-sidebar floating nav-fixed quarto-light">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a href="./index.html" class="navbar-brand navbar-brand-logo">
    <img src="./research/gallery/willcox_lbl_hs_circ.png" alt="a photo of me" class="navbar-logo">
    </a>
    <a class="navbar-brand" href="./index.html">
    <span class="navbar-title">Don Willcox</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" role="menu" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item">
    <a class="nav-link" href="./index.html"> 
<span class="menu-text">Home</span></a>
  </li>  
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-research" role="link" data-bs-toggle="dropdown" aria-expanded="false">
 <span class="menu-text">Research</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-research">    
        <li>
    <a class="dropdown-item" href="./research.html">
 <span class="dropdown-text">Research Highlights</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./thermonuclear_supernovae.html">
 <span class="dropdown-text">Thermonuclear Supernovae</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./nuclear_reactions.html">
 <span class="dropdown-text">Nuclear Reactions</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./ml_reactions.html">
 <span class="dropdown-text">Machine Learning For Surrogate Models</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./neutron_stars.html">
 <span class="dropdown-text">Neutron Stars</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./neutrino_quantum_kinetics.html">
 <span class="dropdown-text">Neutrino Quantum Kinetics</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./pde_code_generation.html">
 <span class="dropdown-text">Solving PDEs With Code Generation</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./mesoscale.html">
 <span class="dropdown-text">Energy Research and Forecasting</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./compsci_philosophy.html">
 <span class="dropdown-text">Computational Science Philosophy</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./research_horizons.html">
 <span class="dropdown-text">What’s Next?</span></a>
  </li>  
    </ul>
  </li>
  <li class="nav-item">
    <a class="nav-link" href="./codes.html"> 
<span class="menu-text">Codes</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="./talks.html"> 
<span class="menu-text">Talks</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="./publications.html"> 
<span class="menu-text">Publications</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="./cv.html"> 
<span class="menu-text">CV</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="./bio.html"> 
<span class="menu-text">Bio</span></a>
  </li>  
</ul>
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item compact">
    <a class="nav-link" href="mailto:eugene.willcox@gmail.com"> <i class="bi bi-envelope-at-fill" role="img">
</i> 
<span class="menu-text"></span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="https://github.com/dwillcox"> <i class="bi bi-github" role="img">
</i> 
<span class="menu-text"></span></a>
  </li>  
</ul>
          </div> <!-- /navcollapse -->
            <div class="quarto-navbar-tools">
  <a href="" class="quarto-color-scheme-toggle quarto-navigation-tool  px-1" onclick="window.quartoToggleColorScheme(); return false;" title="Toggle dark mode"><i class="bi"></i></a>
  <a href="" class="quarto-reader-toggle quarto-navigation-tool px-1" onclick="window.quartoToggleReader(); return false;" title="Toggle reader mode">
  <div class="quarto-reader-toggle-btn">
  <i class="bi"></i>
  </div>
</a>
</div>
      </div> <!-- /container-fluid -->
    </nav>
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./neutrino_quantum_kinetics.html">Neutrino Quantum Kinetics</a></li></ol></nav>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto">
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./research.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Research Highlights</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./thermonuclear_supernovae.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Thermonuclear Supernovae</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./nuclear_reactions.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Nuclear Reactions</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ml_reactions.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Machine Learning For Surrogate Models</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./neutron_stars.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Neutron Stars</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./neutrino_quantum_kinetics.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text">Neutrino Quantum Kinetics</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./pde_code_generation.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Solving PDEs With Code Generation</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./mesoscale.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Energy Research and Forecasting</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./compsci_philosophy.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Computational Science Philosophy</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./research_horizons.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">What’s Next?</span></a>
  </div>
</li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#neutrino-quantum-kinetics" id="toc-neutrino-quantum-kinetics" class="nav-link active" data-scroll-target="#neutrino-quantum-kinetics">Neutrino Quantum Kinetics</a>
  <ul class="collapse">
  <li><a href="#neutrino-quantum-kinetics-influences-heavy-element-creation-but-is-challenging-to-predict" id="toc-neutrino-quantum-kinetics-influences-heavy-element-creation-but-is-challenging-to-predict" class="nav-link" data-scroll-target="#neutrino-quantum-kinetics-influences-heavy-element-creation-but-is-challenging-to-predict">Neutrino Quantum Kinetics Influences Heavy Element Creation, But Is Challenging To Predict!</a></li>
  <li><a href="#neutrino-quantum-flavor-instabilities-play-a-critical-role-requiring-specialized-code" id="toc-neutrino-quantum-flavor-instabilities-play-a-critical-role-requiring-specialized-code" class="nav-link" data-scroll-target="#neutrino-quantum-flavor-instabilities-play-a-critical-role-requiring-specialized-code">Neutrino Quantum Flavor Instabilities Play A Critical Role, Requiring Specialized Code</a></li>
  <li><a href="#predicting-neutrino-flavor-in-astrophysics-requires-writing-code-that-combines-radiation-transport-and-quantum-mechanics" id="toc-predicting-neutrino-flavor-in-astrophysics-requires-writing-code-that-combines-radiation-transport-and-quantum-mechanics" class="nav-link" data-scroll-target="#predicting-neutrino-flavor-in-astrophysics-requires-writing-code-that-combines-radiation-transport-and-quantum-mechanics">Predicting Neutrino Flavor in Astrophysics Requires Writing Code That Combines Radiation Transport And Quantum Mechanics</a></li>
  <li><a href="#we-created-emu-a-six-dimensional-three-flavor-code-to-solve-neutrino-quantum-kinetics" id="toc-we-created-emu-a-six-dimensional-three-flavor-code-to-solve-neutrino-quantum-kinetics" class="nav-link" data-scroll-target="#we-created-emu-a-six-dimensional-three-flavor-code-to-solve-neutrino-quantum-kinetics">We Created Emu: A Six-Dimensional, Three-Flavor Code To Solve Neutrino Quantum Kinetics</a>
  <ul class="collapse">
  <li><a href="#we-validated-emu-by-simulating-neutrino-fast-flavor-instabilities-in-one-spatial-dimension" id="toc-we-validated-emu-by-simulating-neutrino-fast-flavor-instabilities-in-one-spatial-dimension" class="nav-link" data-scroll-target="#we-validated-emu-by-simulating-neutrino-fast-flavor-instabilities-in-one-spatial-dimension">We Validated Emu By Simulating Neutrino Fast Flavor Instabilities In One Spatial Dimension</a></li>
  <li><a href="#emu-enables-us-to-simulate-neutrino-fast-flavor-instabilities-in-three-spatial-dimensions" id="toc-emu-enables-us-to-simulate-neutrino-fast-flavor-instabilities-in-three-spatial-dimensions" class="nav-link" data-scroll-target="#emu-enables-us-to-simulate-neutrino-fast-flavor-instabilities-in-three-spatial-dimensions">Emu Enables Us To Simulate Neutrino Fast Flavor Instabilities In Three Spatial Dimensions</a></li>
  </ul></li>
  </ul></li>
  </ul>
<div class="toc-actions"><ul><li><a href="https://github.com/dwillcox/dwillcox.github.io/blob/main/neutrino_quantum_kinetics.qmd" class="toc-action"><i class="bi bi-github"></i>View source</a></li><li><a href="https://github.com/dwillcox/dwillcox.github.io/issues/new" class="toc-action"><i class="bi empty"></i>Report an issue</a></li></ul></div></nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content"><header id="title-block-header" class="quarto-title-block"></header>
<script id="quarto-html-before-body" type="application/javascript">
    const toggleBodyColorMode = (bsSheetEl) => {
      const mode = bsSheetEl.getAttribute("data-mode");
      const bodyEl = window.document.querySelector("body");
      if (mode === "dark") {
        bodyEl.classList.add("quarto-dark");
        bodyEl.classList.remove("quarto-light");
      } else {
        bodyEl.classList.add("quarto-light");
        bodyEl.classList.remove("quarto-dark");
      }
    }
    const toggleBodyColorPrimary = () => {
      const bsSheetEl = window.document.querySelector("link#quarto-bootstrap:not([rel=disabled-stylesheet])");
      if (bsSheetEl) {
        toggleBodyColorMode(bsSheetEl);
      }
    }
    toggleBodyColorPrimary();
    const toggleColorMode = (alternate) => {
      // Switch the stylesheets
      const primaryStylesheets = window.document.querySelectorAll('link.quarto-color-scheme:not(.quarto-color-alternate)');
      const alternateStylesheets = window.document.querySelectorAll('link.quarto-color-scheme.quarto-color-alternate');
      manageTransitions('#quarto-margin-sidebar .nav-link', false);
      if (alternate) {
        disableStylesheet(primaryStylesheets)
        enableStylesheet(alternateStylesheets);
        for (const sheetNode of alternateStylesheets) {
          if (sheetNode.id === "quarto-bootstrap") {
            toggleBodyColorMode(sheetNode);
          }
        }
      } else {
        disableStylesheet(alternateStylesheets);
        enableStylesheet(primaryStylesheets)
        toggleBodyColorPrimary();
      }
      manageTransitions('#quarto-margin-sidebar .nav-link', true);
      // Switch the toggles
      const toggles = window.document.querySelectorAll('.quarto-color-scheme-toggle');
      for (let i=0; i < toggles.length; i++) {
        const toggle = toggles[i];
        if (toggle) {
          if (alternate) {
            toggle.classList.add("alternate");
          } else {
            toggle.classList.remove("alternate");
          }
        }
      }
      // Hack to workaround the fact that safari doesn't
      // properly recolor the scrollbar when toggling (#1455)
      if (navigator.userAgent.indexOf('Safari') > 0 && navigator.userAgent.indexOf('Chrome') == -1) {
        manageTransitions("body", false);
        window.scrollTo(0, 1);
        setTimeout(() => {
          window.scrollTo(0, 0);
          manageTransitions("body", true);
        }, 40);
      }
    }
    const disableStylesheet = (stylesheets) => {
      for (let i=0; i < stylesheets.length; i++) {
        const stylesheet = stylesheets[i];
        stylesheet.rel = 'disabled-stylesheet';
      }
    }
    const enableStylesheet = (stylesheets) => {
      for (let i=0; i < stylesheets.length; i++) {
        const stylesheet = stylesheets[i];
        if(stylesheet.rel !== 'stylesheet') { // for Chrome, which will still FOUC without this check
          stylesheet.rel = 'stylesheet';
        }
      }
    }
    const manageTransitions = (selector, allowTransitions) => {
      const els = window.document.querySelectorAll(selector);
      for (let i=0; i < els.length; i++) {
        const el = els[i];
        if (allowTransitions) {
          el.classList.remove('notransition');
        } else {
          el.classList.add('notransition');
        }
      }
    }
    const isFileUrl = () => {
      return window.location.protocol === 'file:';
    }
    const hasAlternateSentinel = () => {
      let styleSentinel = getColorSchemeSentinel();
      if (styleSentinel !== null) {
        return styleSentinel === "alternate";
      } else {
        return false;
      }
    }
    const setStyleSentinel = (alternate) => {
      const value = alternate ? "alternate" : "default";
      if (!isFileUrl()) {
        window.localStorage.setItem("quarto-color-scheme", value);
      } else {
        localAlternateSentinel = value;
      }
    }
    const getColorSchemeSentinel = () => {
      if (!isFileUrl()) {
        const storageValue = window.localStorage.getItem("quarto-color-scheme");
        return storageValue != null ? storageValue : localAlternateSentinel;
      } else {
        return localAlternateSentinel;
      }
    }
    const darkModeDefault = false;
    let localAlternateSentinel = darkModeDefault ? 'alternate' : 'default';
    // Dark / light mode switch
    window.quartoToggleColorScheme = () => {
      // Read the current dark / light value
      let toAlternate = !hasAlternateSentinel();
      toggleColorMode(toAlternate);
      setStyleSentinel(toAlternate);
      toggleGiscusIfUsed(toAlternate, darkModeDefault);
    };
    // Switch to dark mode if need be
    if (hasAlternateSentinel()) {
      toggleColorMode(true);
    } else {
      toggleColorMode(false);
    }
  </script>




<section id="neutrino-quantum-kinetics" class="level1">
<h1>Neutrino Quantum Kinetics</h1>
<p>In certain high energy astrophysics contexts, like core-collapse supernovae and neutron star mergers, neutrinos are radiated at such high densities they are capable of exhibiting collective behavior as a many-body quantum system. At the same time, neutrinos travel at nearly the speed of light and must be modeled using the techniques of radiation transport, this is the kinetics part.</p>
<section id="neutrino-quantum-kinetics-influences-heavy-element-creation-but-is-challenging-to-predict" class="level2">
<h2 class="anchored" data-anchor-id="neutrino-quantum-kinetics-influences-heavy-element-creation-but-is-challenging-to-predict">Neutrino Quantum Kinetics Influences Heavy Element Creation, But Is Challenging To Predict!</h2>
<p>It so happens that neutron star mergers, and to a lesser extent, core collapse supernovae, are understood by astrophysicists to produce the majority of all elements heavier than iron on the periodic table, such as gold. Since neutrinos interact with neutrons and protons, neutrinos influence the likelihood of various nucleosynthesis pathways for creating all these heavy elements.</p>
<p>But how can we make accurate estimations of which astrophysics events produced various quantities of elements? Well, we observe radiation spectra from these events, then we match these observed spectra with detailed computational models of the explosion and the radiation it produces to determine the starting conditions for the explosion.</p>
<p>But computing the influence of neutrinos is fairly difficult, we have to solve a radiation transport problem in six dimensions (three space plus two angular dimensions plus time). Then as if radiation transport weren’t difficult enough, we need to solve a many-body quantum mechanics problem to evolve the neutrino flavor states.</p>
</section>
<section id="neutrino-quantum-flavor-instabilities-play-a-critical-role-requiring-specialized-code" class="level2">
<h2 class="anchored" data-anchor-id="neutrino-quantum-flavor-instabilities-play-a-critical-role-requiring-specialized-code">Neutrino Quantum Flavor Instabilities Play A Critical Role, Requiring Specialized Code</h2>
<p>If the quantum mechanics of neutrinos is hard to simulate, we might naturally ask what makes the neutrino quantum flavor state so important in the first place.</p>
<p>Getting the neutrino quantum state right is important because under certain conditions, theorists have found neutrinos can evolve fast flavor instabilities (FFI). Under FFI conditions, the overall neutrino flavor state very rapidly destabilizes before approaching a completely different equilibrium state over longer timescales.</p>
<p>The problem is that these FFI events can occur in volumes of space that would fit into the palm of one’s hand, over timescales measured in just a few nanoseconds. This is far faster than explosion simulations can possibly capture, so we need to write a specialized simulation code just for neutrino quantum kinetics.</p>
<p>We can then predict what conditions could lead to FFI and the long term outcomes to provide effective models for larger, more complete simulations of the entire explosion event.</p>
</section>
<section id="predicting-neutrino-flavor-in-astrophysics-requires-writing-code-that-combines-radiation-transport-and-quantum-mechanics" class="level2">
<h2 class="anchored" data-anchor-id="predicting-neutrino-flavor-in-astrophysics-requires-writing-code-that-combines-radiation-transport-and-quantum-mechanics">Predicting Neutrino Flavor in Astrophysics Requires Writing Code That Combines Radiation Transport And Quantum Mechanics</h2>
<p>We can start by considering what we need to solve the kinetic, transport aspect of neutrino evolution.</p>
<p>Sometimes transport problems are best solved with Lagrangian techniques, which represent the solution as a collection of particles.</p>
<p>Lagrangian techniques are often an efficient choice for simulating transport because a solution made up of uniquely moving particles is one way to reduce certain artificial diffusion errors in Eulerian transport models based on a fixed spatial grid.</p>
<p>Lagrangian particles may interact with each other and with matter or fields extending throughout the simulation domain.</p>
<p>Why are Lagrangian methods important? Well, they are exactly what we needed for neutrino quantum kinetics.</p>
<p>Neutrinos are nearly massless and so move at nearly the speed of light. They carry no electrical charge, but they do carry a quantum state called flavor in particle physics.</p>
<p>Neutrinos arise in large numbers from core collapse supernovae and neutron star merger events in high-energy astrophysics. In such cases, we naturally model neutrinos as radiation we must transport, so we chose a Lagrangian approach.</p>
<p>Each Lagrangian particle thus represents a number of physical neutrinos. These physical neutrinos have an average flavor state we represent with a <span class="math inline">\(3 \times 3\)</span> Hermitian matrix associated with the Lagrangian particle.</p>
<p>Thus, not only must our code transport Lagrangian particles, we must also evolve the flavor state matrix associated with each particle.</p>
<p>I developed a framework based on AMReX for evolving equations associated with Lagrangian particles using global Runge-Kutta time integration. We generated the C++ code each particle must integrate to evolve its complex-valued flavor state matrix using the Sympy package for symbolic mathematics.</p>
<p>When we consider the dynamics of evolving the neutrino flavor state due to neutrino-neutrino and neutrino-matter interactions, the mean-field approximation seemed a natural choice for solving the complex neutrino quantum kinetics equations.</p>
<p>We implemented the mean-field approximation using a background spatial grid where we averaged the surrounding particle quantum flavor states. In turn, we interpolated back from the spatial grid to the particle locations in each spatial cell to calculate the time derivative for the particle flavor state matrix. This technique is called a Particle-In-Cell (PIC) Method.</p>
<p>Our code generation approach with Runge-Kutta integration for the Particle-In-Cell Method is the framework of the Emu simulation code I developed with Sherwood Richers to solve the six-dimensional neutrino quantum kinetics problem.</p>
</section>
<section id="we-created-emu-a-six-dimensional-three-flavor-code-to-solve-neutrino-quantum-kinetics" class="level2">
<h2 class="anchored" data-anchor-id="we-created-emu-a-six-dimensional-three-flavor-code-to-solve-neutrino-quantum-kinetics">We Created Emu: A Six-Dimensional, Three-Flavor Code To Solve Neutrino Quantum Kinetics</h2>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Get Emu
</div>
</div>
<div class="callout-body-container callout-body">
<p>Emu is an open-source code, freely available on the <a href="https://github.com/AMReX-Astro/Emu">Emu GitHub</a>.</p>
<p>We also openly published the Emu inputs files anyone could use to reproduce our published work.</p>
</div>
</div>
<p>In summary, I worked with Sherwood Richers to create Emu, a new simulation code based on the particle-in-cell technique to solve neutrino quantum kinetics in the mean field approximation.</p>
<p>Emu evolves the neutrino radiation field using Lagrangian particles traveling atop an underlying spatial mesh that contains the mean field quantum many-body state as well as the nuclear matter background.</p>
<section id="we-validated-emu-by-simulating-neutrino-fast-flavor-instabilities-in-one-spatial-dimension" class="level3">
<h3 class="anchored" data-anchor-id="we-validated-emu-by-simulating-neutrino-fast-flavor-instabilities-in-one-spatial-dimension">We Validated Emu By Simulating Neutrino Fast Flavor Instabilities In One Spatial Dimension</h3>
<p>We started with one-dimension in space, two dimensions in angle, and three neutrino flavors to evaluate the dynamics of FFI under conditions where other simulation codes provided a means of comparison. We published this work in our first Emu paper.</p>
<p>For details, see <span class="citation" data-cites="richers_pic_2021">Richers et al. (<a href="#ref-richers_pic_2021" role="doc-biblioref">2021a</a>)</span>.</p>
</section>
<section id="emu-enables-us-to-simulate-neutrino-fast-flavor-instabilities-in-three-spatial-dimensions" class="level3">
<h3 class="anchored" data-anchor-id="emu-enables-us-to-simulate-neutrino-fast-flavor-instabilities-in-three-spatial-dimensions">Emu Enables Us To Simulate Neutrino Fast Flavor Instabilities In Three Spatial Dimensions</h3>
<p>After validating our method and publishing our numerical technique in our first paper, we moved on to the exciting challenge of fully three-dimensional simulations.</p>
<p>This time, we wanted to capture all three dimensions of the volume of space neutrinos traversed while undergoing fast flavor instability. We also wanted to simulate all angular directions in which neutrinos could travel over the full instability timescale.</p>
<p>We were able to easily discretize these dimensions because we used Lagrangian particles to represent groups of neutrinos located anywhere in our three-dimensional simulation domain and moving in any of two angular directions covering the unit sphere.</p>
<p>We then evolved the neutrinos forward in time using Runge-Kutta integration, for a total of 6 dimensions of space, angle, and time.</p>
<p>Our Emu code enabled us to simulate the neutrino fast flavor instability in all six dimensions with all three neutrino flavor states.</p>
<p>We repeated the FFI conditions in our earlier one-dimensional paper, again with all three neutrino flavors and published our work in a follow-up paper.</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="research/publications/pub0018/pub0018_f2_emu_3d_ffi.png" class="img-fluid figure-img"></p>
<figcaption>Emu 3D FFI Simulation</figcaption>
</figure>
</div>
<p>For details, see <span class="citation" data-cites="richers_neutrino3D_2021">Richers et al. (<a href="#ref-richers_neutrino3D_2021" role="doc-biblioref">2021b</a>)</span>.</p>



</section>
</section>
</section>

<a onclick="window.scrollTo(0, 0); return false;" role="button" id="quarto-back-to-top"><i class="bi bi-arrow-up"></i> Back to top</a><div id="quarto-appendix" class="default"><section class="quarto-appendix-contents" role="doc-bibliography" id="quarto-bibliography"><h2 class="anchored quarto-appendix-heading">References</h2><div id="refs" class="references csl-bib-body" data-entry-spacing="1" role="list">
<div id="ref-richers_pic_2021" class="csl-entry" role="listitem">
Richers, S., Willcox, D. E., Ford, N. M., &amp; Myers, A. 2021a, Phys Rev D, 103, 083013, <a href="https://link.aps.org/doi/10.1103/PhysRevD.103.083013">https://link.aps.org/doi/10.1103/PhysRevD.103.083013</a>
</div>
<div id="ref-richers_neutrino3D_2021" class="csl-entry" role="listitem">
Richers, S., Willcox, D., &amp; Ford, N. 2021b, Phys Rev D, 104, 103023, <a href="https://link.aps.org/doi/10.1103/PhysRevD.104.103023">https://link.aps.org/doi/10.1103/PhysRevD.104.103023</a>
</div>
</div></section></div></main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
  window.document.addEventListener("DOMContentLoaded", function (event) {
    // Ensure there is a toggle, if there isn't float one in the top right
    if (window.document.querySelector('.quarto-color-scheme-toggle') === null) {
      const a = window.document.createElement('a');
      a.classList.add('top-right');
      a.classList.add('quarto-color-scheme-toggle');
      a.href = "";
      a.onclick = function() { try { window.quartoToggleColorScheme(); } catch {} return false; };
      const i = window.document.createElement("i");
      i.classList.add('bi');
      a.appendChild(i);
      window.document.body.appendChild(a);
    }
    const toggleGiscusIfUsed = (isAlternate, darkModeDefault) => {
      const baseTheme = document.querySelector('#giscus-base-theme')?.value ?? 'light';
      const alternateTheme = document.querySelector('#giscus-alt-theme')?.value ?? 'dark';
      let newTheme = '';
      if(darkModeDefault) {
        newTheme = isAlternate ? baseTheme : alternateTheme;
      } else {
        newTheme = isAlternate ? alternateTheme : baseTheme;
      }
      const changeGiscusTheme = () => {
        // From: https://github.com/giscus/giscus/issues/336
        const sendMessage = (message) => {
          const iframe = document.querySelector('iframe.giscus-frame');
          if (!iframe) return;
          iframe.contentWindow.postMessage({ giscus: message }, 'https://giscus.app');
        }
        sendMessage({
          setConfig: {
            theme: newTheme
          }
        });
      }
      const isGiscussLoaded = window.document.querySelector('iframe.giscus-frame') !== null;
      if (isGiscussLoaded) {
        changeGiscusTheme();
      }
    }
    const icon = "";
    const anchorJS = new window.AnchorJS();
    anchorJS.options = {
      placement: 'right',
      icon: icon
    };
    anchorJS.add('.anchored');
    const isCodeAnnotation = (el) => {
      for (const clz of el.classList) {
        if (clz.startsWith('code-annotation-')) {                     
          return true;
        }
      }
      return false;
    }
    const onCopySuccess = function(e) {
      // button target
      const button = e.trigger;
      // don't keep focus
      button.blur();
      // flash "checked"
      button.classList.add('code-copy-button-checked');
      var currentTitle = button.getAttribute("title");
      button.setAttribute("title", "Copied!");
      let tooltip;
      if (window.bootstrap) {
        button.setAttribute("data-bs-toggle", "tooltip");
        button.setAttribute("data-bs-placement", "left");
        button.setAttribute("data-bs-title", "Copied!");
        tooltip = new bootstrap.Tooltip(button, 
          { trigger: "manual", 
            customClass: "code-copy-button-tooltip",
            offset: [0, -8]});
        tooltip.show();    
      }
      setTimeout(function() {
        if (tooltip) {
          tooltip.hide();
          button.removeAttribute("data-bs-title");
          button.removeAttribute("data-bs-toggle");
          button.removeAttribute("data-bs-placement");
        }
        button.setAttribute("title", currentTitle);
        button.classList.remove('code-copy-button-checked');
      }, 1000);
      // clear code selection
      e.clearSelection();
    }
    const getTextToCopy = function(trigger) {
        const codeEl = trigger.previousElementSibling.cloneNode(true);
        for (const childEl of codeEl.children) {
          if (isCodeAnnotation(childEl)) {
            childEl.remove();
          }
        }
        return codeEl.innerText;
    }
    const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
      text: getTextToCopy
    });
    clipboard.on('success', onCopySuccess);
    if (window.document.getElementById('quarto-embedded-source-code-modal')) {
      const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
        text: getTextToCopy,
        container: window.document.getElementById('quarto-embedded-source-code-modal')
      });
      clipboardModal.on('success', onCopySuccess);
    }
      var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var mailtoRegex = new RegExp(/^mailto:/);
        var filterRegex = new RegExp('/' + window.location.host + '/');
      var isInternal = (href) => {
          return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
      }
      // Inspect non-navigation links and adorn them if external
     var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
      for (var i=0; i<links.length; i++) {
        const link = links[i];
        if (!isInternal(link.href)) {
          // undo the damage that might have been done by quarto-nav.js in the case of
          // links that we want to consider external
          if (link.dataset.originalHref !== undefined) {
            link.href = link.dataset.originalHref;
          }
        }
      }
    function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
      const config = {
        allowHTML: true,
        maxWidth: 500,
        delay: 100,
        arrow: false,
        appendTo: function(el) {
            return el.parentElement;
        },
        interactive: true,
        interactiveBorder: 10,
        theme: 'quarto',
        placement: 'bottom-start',
      };
      if (contentFn) {
        config.content = contentFn;
      }
      if (onTriggerFn) {
        config.onTrigger = onTriggerFn;
      }
      if (onUntriggerFn) {
        config.onUntrigger = onUntriggerFn;
      }
      window.tippy(el, config); 
    }
    const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
    for (var i=0; i<noterefs.length; i++) {
      const ref = noterefs[i];
      tippyHover(ref, function() {
        // use id or data attribute instead here
        let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
        try { href = new URL(href).hash; } catch {}
        const id = href.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note) {
          return note.innerHTML;
        } else {
          return "";
        }
      });
    }
    const xrefs = window.document.querySelectorAll('a.quarto-xref');
    const processXRef = (id, note) => {
      // Strip column container classes
      const stripColumnClz = (el) => {
        el.classList.remove("page-full", "page-columns");
        if (el.children) {
          for (const child of el.children) {
            stripColumnClz(child);
          }
        }
      }
      stripColumnClz(note)
      if (id === null || id.startsWith('sec-')) {
        // Special case sections, only their first couple elements
        const container = document.createElement("div");
        if (note.children && note.children.length > 2) {
          container.appendChild(note.children[0].cloneNode(true));
          for (let i = 1; i < note.children.length; i++) {
            const child = note.children[i];
            if (child.tagName === "P" && child.innerText === "") {
              continue;
            } else {
              container.appendChild(child.cloneNode(true));
              break;
            }
          }
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(container);
          }
          return container.innerHTML
        } else {
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(note);
          }
          return note.innerHTML;
        }
      } else {
        // Remove any anchor links if they are present
        const anchorLink = note.querySelector('a.anchorjs-link');
        if (anchorLink) {
          anchorLink.remove();
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        if (note.classList.contains("callout")) {
          return note.outerHTML;
        } else {
          return note.innerHTML;
        }
      }
    }
    for (var i=0; i<xrefs.length; i++) {
      const xref = xrefs[i];
      tippyHover(xref, undefined, function(instance) {
        instance.disable();
        let url = xref.getAttribute('href');
        let hash = undefined; 
        if (url.startsWith('#')) {
          hash = url;
        } else {
          try { hash = new URL(url).hash; } catch {}
        }
        if (hash) {
          const id = hash.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          if (note !== null) {
            try {
              const html = processXRef(id, note.cloneNode(true));
              instance.setContent(html);
            } finally {
              instance.enable();
              instance.show();
            }
          } else {
            // See if we can fetch this
            fetch(url.split('#')[0])
            .then(res => res.text())
            .then(html => {
              const parser = new DOMParser();
              const htmlDoc = parser.parseFromString(html, "text/html");
              const note = htmlDoc.getElementById(id);
              if (note !== null) {
                const html = processXRef(id, note);
                instance.setContent(html);
              } 
            }).finally(() => {
              instance.enable();
              instance.show();
            });
          }
        } else {
          // See if we can fetch a full url (with no hash to target)
          // This is a special case and we should probably do some content thinning / targeting
          fetch(url)
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.querySelector('main.content');
            if (note !== null) {
              // This should only happen for chapter cross references
              // (since there is no id in the URL)
              // remove the first header
              if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
                note.children[0].remove();
              }
              const html = processXRef(null, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      }, function(instance) {
      });
    }
        let selectedAnnoteEl;
        const selectorForAnnotation = ( cell, annotation) => {
          let cellAttr = 'data-code-cell="' + cell + '"';
          let lineAttr = 'data-code-annotation="' +  annotation + '"';
          const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
          return selector;
        }
        const selectCodeLines = (annoteEl) => {
          const doc = window.document;
          const targetCell = annoteEl.getAttribute("data-target-cell");
          const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
          const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
          const lines = annoteSpan.getAttribute("data-code-lines").split(",");
          const lineIds = lines.map((line) => {
            return targetCell + "-" + line;
          })
          let top = null;
          let height = null;
          let parent = null;
          if (lineIds.length > 0) {
              //compute the position of the single el (top and bottom and make a div)
              const el = window.document.getElementById(lineIds[0]);
              top = el.offsetTop;
              height = el.offsetHeight;
              parent = el.parentElement.parentElement;
            if (lineIds.length > 1) {
              const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
              const bottom = lastEl.offsetTop + lastEl.offsetHeight;
              height = bottom - top;
            }
            if (top !== null && height !== null && parent !== null) {
              // cook up a div (if necessary) and position it 
              let div = window.document.getElementById("code-annotation-line-highlight");
              if (div === null) {
                div = window.document.createElement("div");
                div.setAttribute("id", "code-annotation-line-highlight");
                div.style.position = 'absolute';
                parent.appendChild(div);
              }
              div.style.top = top - 2 + "px";
              div.style.height = height + 4 + "px";
              div.style.left = 0;
              let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
              if (gutterDiv === null) {
                gutterDiv = window.document.createElement("div");
                gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
                gutterDiv.style.position = 'absolute';
                const codeCell = window.document.getElementById(targetCell);
                const gutter = codeCell.querySelector('.code-annotation-gutter');
                gutter.appendChild(gutterDiv);
              }
              gutterDiv.style.top = top - 2 + "px";
              gutterDiv.style.height = height + 4 + "px";
            }
            selectedAnnoteEl = annoteEl;
          }
        };
        const unselectCodeLines = () => {
          const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
          elementsIds.forEach((elId) => {
            const div = window.document.getElementById(elId);
            if (div) {
              div.remove();
            }
          });
          selectedAnnoteEl = undefined;
        };
          // Handle positioning of the toggle
      window.addEventListener(
        "resize",
        throttle(() => {
          elRect = undefined;
          if (selectedAnnoteEl) {
            selectCodeLines(selectedAnnoteEl);
          }
        }, 10)
      );
      function throttle(fn, ms) {
      let throttle = false;
      let timer;
        return (...args) => {
          if(!throttle) { // first call gets through
              fn.apply(this, args);
              throttle = true;
          } else { // all the others get throttled
              if(timer) clearTimeout(timer); // cancel #2
              timer = setTimeout(() => {
                fn.apply(this, args);
                timer = throttle = false;
              }, ms);
          }
        };
      }
        // Attach click handler to the DT
        const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
        for (const annoteDlNode of annoteDls) {
          annoteDlNode.addEventListener('click', (event) => {
            const clickedEl = event.target;
            if (clickedEl !== selectedAnnoteEl) {
              unselectCodeLines();
              const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
              if (activeEl) {
                activeEl.classList.remove('code-annotation-active');
              }
              selectCodeLines(clickedEl);
              clickedEl.classList.add('code-annotation-active');
            } else {
              // Unselect the line
              unselectCodeLines();
              clickedEl.classList.remove('code-annotation-active');
            }
          });
        }
    const findCites = (el) => {
      const parentEl = el.parentElement;
      if (parentEl) {
        const cites = parentEl.dataset.cites;
        if (cites) {
          return {
            el,
            cites: cites.split(' ')
          };
        } else {
          return findCites(el.parentElement)
        }
      } else {
        return undefined;
      }
    };
    var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
    for (var i=0; i<bibliorefs.length; i++) {
      const ref = bibliorefs[i];
      const citeInfo = findCites(ref);
      if (citeInfo) {
        tippyHover(citeInfo.el, function() {
          var popup = window.document.createElement('div');
          citeInfo.cites.forEach(function(cite) {
            var citeDiv = window.document.createElement('div');
            citeDiv.classList.add('hanging-indent');
            citeDiv.classList.add('csl-entry');
            var biblioDiv = window.document.getElementById('ref-' + cite);
            if (biblioDiv) {
              citeDiv.innerHTML = biblioDiv.innerHTML;
            }
            popup.appendChild(citeDiv);
          });
          return popup.innerHTML;
        });
      }
    }
  });
  </script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="./neutron_stars.html" class="pagination-link" aria-label="Neutron Stars">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text">Neutron Stars</span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./pde_code_generation.html" class="pagination-link" aria-label="Solving PDEs With Code Generation">
        <span class="nav-page-text">Solving PDEs With Code Generation</span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->
<footer class="footer">
  <div class="nav-footer">
    <div class="nav-footer-left">
      &nbsp;
    </div>   
    <div class="nav-footer-center">
<p>Copyright 2025, Don E. Willcox</p>
<div class="toc-actions d-sm-block d-md-none"><ul><li><a href="https://github.com/dwillcox/dwillcox.github.io/blob/main/neutrino_quantum_kinetics.qmd" class="toc-action"><i class="bi bi-github"></i>View source</a></li><li><a href="https://github.com/dwillcox/dwillcox.github.io/issues/new" class="toc-action"><i class="bi empty"></i>Report an issue</a></li></ul></div></div>
    <div class="nav-footer-right">
      &nbsp;
    </div>
  </div>
</footer>




</body></html>